config:
  name: device库接口
  variables:
    time: ${get_time()}
  headers:
    User-Agent-Platform: Dalvik/2.1.0 (Linux; U; Android 10; GLK-AL00 Build/HUAWEIGLK-AL00)
    lib_net_work_version: 3.0.1
    User-Agent: Dalvik/2.1.0 (Linux; U; Android 10; GLK-AL00 Build/HUAWEIGLK-AL00)
    Connection: close
    Content-Type: application/json; charset=UTF-8

teststeps:
  - name:
    request:
      method: POST
      url: ${url($is_test,$host,api)}/common/regist_device_v3
      headers:
        app-id: $appid
        device-brand: HUAWEI
        device-model: GLK-AL00
        lib_net_work_version: 3.0.1
        platform: android
        qid: $qid
        udi: $udi
        ver: 1.0.1
      body:
        device_id: ""
        imei: ""
        imei1: ""
        imei2: ""
        installDate: "2023-03-09 10:35:50"
        mac: ""
        oaid: $oaid
        sign: ${get_str_md5($oaid, $ware_id, $imei, $time, $udi, $DEVICE_SECRET)}
        time: $time
        type: "1"
        udi: $udi
        ware_id: $ware_id
    validate:
      - check: status_code
        assert: equals
        expect: 200
        msg: assert response status code
      - check: headers."Content-Type"
        assert: equals
        expect: application/json; charset=utf-8
        msg: assert response header Content-Type
      - check: body.error_code
        assert: equals
        expect: 0
        msg: assert response body error_code
      - check: body.error_message
        assert: equals
        expect: ""
        msg: assert response body error_message
      - check: body.meta
        assert: equals
        expect: ""
        msg: assert response body meta
  - name: ""
    request:
      method: POST
      url: ${url($is_test,$host,api)}/common/save_device_v3
      headers:
        app-id: $appid
        device-brand: HUAWEI
        device-model: GLK-AL00
        lib_net_work_version: 3.0.1
        platform: android
        qid: $qid
        udi: $udi
        ver: 1.0.1
      body:
        android_version: "10"
        brand: HUAWEI
        cpu: AArch64 Processor rev 2 (aarch64)
        cpu_cores: "8"
        device_id: ""
        display_version: GLK-AL00 2.0.0.291(C00E230R1P5)
        imei: ""
        imei1: ""
        imei2: ""
        is_phone: "true"
        is_root: "false"
        model: GLK-AL00
        oaid: $oaid
        per_tongzhi: "false"
        psuedo_unique_id: "335144668878244"
        ratio: 1080*2208
        sdk_version_code: "29"
        sdk_version_name: "10"
        sim_operator: ""
        supported_abis: arm64-v8a,armeabi-v7a,armeabi
        udi: $udi
        ware_id: $ware_id
        wifi_essid: ""
    validate:
      - check: status_code
        assert: equals
        expect: 200
        msg: assert response status code
      - check: headers."Content-Type"
        assert: equals
        expect: application/json; charset=utf-8
        msg: assert response header Content-Type
      - check: body.error_code
        assert: equals
        expect: 0
        msg: assert response body error_code
      - check: body.error_message
        assert: equals
        expect: ""
        msg: assert response body error_message
      - check: body.meta
        assert: equals
        expect: ""
        msg: assert response body meta
  - name: ""
    request:
      method: POST
      url: ${url($is_test,$host,api)}/common/backhaul/info/v2
      headers:
        app-id: $appid
        device-brand: HUAWEI
        device-model: GLK-AL00
        lib_net_work_version: 3.0.1
        platform: android
        qid: $qid
        udi: $udi
        ver: 1.0.1
      body:
        imei: ""
        install_date: "2023-03-09 10:35:50"
        oaid: $oaid
        udi: $udi
        ware_id: $ware_id
    validate:
      - check: status_code
        assert: equals
        expect: 200
        msg: assert response status code
      - check: headers."Content-Type"
        assert: equals
        expect: application/json; charset=utf-8
        msg: assert response header Content-Type
      - check: body.error_code
        assert: equals
        expect: 0
        msg: assert response body error_code
      - check: body.error_message
        assert: equals
        expect: ""
        msg: assert response body error_message
      - check: body.meta
        assert: equals
        expect: ""
        msg: assert response body meta
